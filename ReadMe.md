# Simple Trailer+Cargo Mod
This repo outlines the files, data and procedure required in order to create a new cargo that appears in the Freight and Quick Job market, associated *only* to a particular trailer/skin.

That is to say, imagine a cargo named "Honey", which you want to only spawn on trailers with a giant bee skin. You want this cargo to only appear in this trailer, and you want this trailer to only be used for this cargo.

### Limitations
This isn't a photoshop guide. You can find the templates for trailer skins and other requirements elsewhere. A basic nomenclature guide is given at the end since some things are rather obtuse.

This guide was written "functionally" in the sense that it works, but it's not an efficient workflow. Plenty of things can be done much more quickly, such as creating both base mods at once, and certain naming conventions may not be strictly necessary. Your end goal is for your mod structure to look like what's under the `Mod Data/` subfolder of this repo. If you can get there faster, good on you.

# General Procedure
1. Generate "Simple Trailer Skin" using MS2
2. Generate "Simple Cargo" using MS2
3. Unpack and merge generated files
4. Add `trailer_def`
5. Point cargo to `body_type`
6. Point trailer to `trailder_def`
7. Repackage

# Detailed Procedure
## Step 1 - Generate a Simple Trailer Skin
Pop open MS2 and create a new project, then add the `Standalone trailer` template.  
Fill out the information as usual, with any information you want. Once you're ready, export the mod to a location of your choice.  
At the end of this step, you should have a `.scs` file containing your `Standalone trailer` mod as generated by MS2.

## Step 2 - Generate a "Simple Cargo" Mod
Pop open MS2 and create a new project, then add the `Simple cargo mod` template.  
Fill out the information as usual, with any information you want. Once you're ready, export the mod to the same location of your choice.  
At the end of this step, you should have a `.scs` file containing your `Simple cargo mod` mod as generated by MS2.

## Step 3 - Unpack and Merge Generated Files
`scs` files are just `zip` files. Unpack both generated mods into subfolders so you can access the files, and made a new folder to store your "final" mod in. You should have something like this:  
- `my_cargo_mod/<cargo_mod_files>`
- `my_trailer_mod/<trailer_mod_files>`
- `my_final_mod/`
The next part is a bit tricky, as it will depend on what you've chosen for your mod names and internal names. You will need to merge parts of both mods together into the new folder that was created. In general:
- From your cargo mod subfolder, you need everything under `def/` and `material/`
- From your trailer mod subfolder, you need `automat/`, `vehicle/` and `def/vehicle`
- **!!** At the top level, you'll need `manifest.sii`, `mod_description.txt` and `mod_icon.jpg`. These exist in both generated mods, so pick whichever you'd like. You'll probably want to edit these files manually to add actual descriptions later anyway.

## Step 4 - Add trailer_def File
There is one file not generated by MS2 at all that needs to be added from scratch. Under the `def/vehicle` folder, create another folder called `trailer_defs`. In this folder, create a new file named `<trailer name>.sii`. It would seem the name of the file *must* match the name of the file of your trailer skin. Personally, I always remove the `_ms2` that MS2 adds to keep things simple as well. The contents of this file should match what's in `Mod Data/def/vehicle/trailer_defs/anisfw_tr.sii` in this repo, or can be copied form the relevent files in the base game's defs.  
Additionally, two changes need to be made to the file:
- Line 3, `anisfw_tr` should be changed to a name shorter than 12 characters that represents the kind of trailer this is.
- Line 11, `anisfw_tr` should be changed to a name shorter than 12 characters that represents the kind of trailer this is (can be the same as line 3).
Other values can be adjusted as desired if you know what you're doing.

## Step 5 - Point Cargo to body_type
Under `def/cargo/<your_cargo>.sui`, make sure there is only a single line containing `body_types[]: <type>`, and replace the type with what you entered on *line 11* of the previous step.

## Step 6 - Point Trailer to trailer_def
Under `def/vehicle/trailer/<your_trailer>.sui`, in the first section (trailer definition), make sure there is only one line  
`trailer_definition: trailer_def.<type>`  
Where `type` is once again what you entered on *line 3* of step 4.

## Step 7 - Repackage
Your mod is now complete. Modify the `manifest.sii` if you want, and zip everything *under* `my_final_mod` back up, and rename the `.zip` to `.scs`. Slap it in the mods folder and you're good to go.



# "Glossary"
In general, things can be summed up as:  
`Cargo` -> `body_type/trailer_def` <- `trailer` -> `chassis`

Defined cargo can be loaded onto trailers of a certain body type. The definition of this is mostly fluff, so that things make some sense in-game. You wouldn't load paper into a refrigerated or curtainside trailer, for example.

Defined trailers are made up of multiple parts, for wheels, connectors, and other "accessories", but most importantly of a chassis. The chassis definition is what actually points to the specific model and skin used by a custom trailer.

The "trailer_def" provides the link between these things. Defining gameplay traits of certain kinds of trailers and identifying itself as a certain "body type". The cargo can then idetify which body type(s) are valid carriers for itself. Conversely, the trailer also defines what "trailer_def" is valid to be used with that particular, "physical" trailer.

In order to ensure a certain piece of cargo is used exclusively by one trailer, we essentially create a brand new body type. Pointing our cargo exclusively to this body type ensures it will always be loaded on a trailer valid for that body type. Making sure our custom trailer is the only vehicle pointing towards that trailer_def will make it the only valid trailer for that body type.

To be honest, I have no idea why the trailer points to the trailer_def and not the other way around, nor why the distinction is made between the identifiers of "body_type" and "trailer_def" as they're all part of the same file and, afaict the same process, but here we are.


# Optimized Workflow
### All-in-One
The easiest way to make this entire process much faster for multiple new cargo/trailer combos is by generating all the cargo and standalone trailer mods at once. In MS2 studio, a single cargo mod can hold as many new cargos as you want, and you can add as many standalone trailer templates as you want on top of that. In this case, step number 3 will involve moving a lot more files, and steps 4-5-6 will need to be adjusted based on how many trailers and cargos have been added, but the overall process remains the same.

### Multi-trailer cargos and Multi-cargo Trailers
As explained in the "glossary", the body_type/trailer_def defines the link between trailers and cargo. If you want to reuse your custom skins for multiple cargos, simply point multiple cargos to the same body type, and if you want to be able to use multiple custom trailers for the same cargo, point multiple trailers to the same trailer_def.